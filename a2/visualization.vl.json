{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {
    "text": "Marriage vs Divorce Rates by State, 2024",
    "subtitle": "ABS Marriages & Divorces 2024 · unit: per 1,000 (age 16+)"
  },
  "data": {
    "values": [
      {"state": "New South Wales", "marriage_rate_per_1000_2024": 3.91, "divorce_rate_per_1000_2024": 1.41},
      {"state": "Victoria", "marriage_rate_per_1000_2024": 3.52, "divorce_rate_per_1000_2024": 1.57},
      {"state": "Queensland", "marriage_rate_per_1000_2024": 1.39, "divorce_rate_per_1000_2024": 0.58},
      {"state": "South Australia", "marriage_rate_per_1000_2024": 7.03, "divorce_rate_per_1000_2024": 2.93},
      {"state": "Western Australia", "marriage_rate_per_1000_2024": 0.84, "divorce_rate_per_1000_2024": 0.33},
      {"state": "Tasmania", "marriage_rate_per_1000_2024": 1.29, "divorce_rate_per_1000_2024": 0.52},
      {"state": "Northern Territory", "marriage_rate_per_1000_2024": 6.22, "divorce_rate_per_1000_2024": 4.88},
      {"state": "Australian Capital Territory", "marriage_rate_per_1000_2024": 4.5, "divorce_rate_per_1000_2024": 1.8}
    ]
  },
  "layer": [
    {
      "params": [
        {
          "name": "rate_filter",
          "select": {"type": "point", "fields": ["RateType"], "empty": "all"},
          "bind": "legend"
        }
      ],
      "transform": [
        {
          "fold": ["marriage_rate_per_1000_2024", "divorce_rate_per_1000_2024"],
          "as": ["RateType", "Rate"]
        },
        {
          "calculate": "datum['State/Territory'] || datum.State || datum.state || datum['State '] || 'Unknown'",
          "as": "State"
        },
        {"filter": {"param": "rate_filter"}}
      ],
      "mark": {"type": "bar"},
      "encoding": {
        "x": {
          "field": "State",
          "type": "nominal",
          "title": "State/Territory",
          "sort": "-y"
        },
        "xOffset": {"field": "RateType"},
        "y": {
          "field": "Rate",
          "type": "quantitative",
          "title": "Rate per 1,000"
        },
        "color": {
          "field": "RateType",
          "type": "nominal",
          "title": "Rate Type",
          "scale": {
            "domain": [
              "marriage_rate_per_1000_2024",
              "divorce_rate_per_1000_2024"
            ],
            "range": ["#1f77b4", "#ff7f0e"]
          }
        },
        "tooltip": [
          {"field": "State", "title": "State"},
          {"field": "RateType", "title": "Type"},
          {"field": "Rate", "title": "Rate per 1,000", "format": ".1f"}
        ]
      }
    },
    {
      "mark": {"type": "rule", "color": "red", "strokeDash": [4, 2]},
      "encoding": {"y": {"datum": 5.5}}
    },
    {
      "mark": {
        "type": "text",
        "align": "left",
        "dx": 5,
        "dy": -5,
        "color": "red"
      },
      "encoding": {"y": {"datum": 5.5}, "text": {"value": "National Avg ≈ 5.5"}}
    }
  ],
  "width": 720,
  "height": 480,
  "config": {}
}